---
title: "Overall Results"
author: "Hamza"
date: "30 September 2019"
output:
  pdf_document: default
  html_document: default
  word_document: default
---

```{r load packages, include=FALSE, message=FALSE, warning=FALSE}
library(tidyverse)
library(openxlsx)  
library(knitr)
library(metafor)
library(ggplot2)
library(readxl)

#Install miktex and then run this to knit a pdf file
#install.packages('tinytex')
#tinytex::install_tinytex()
```

## Meta-analysis

### Calculating effect sizes

Here, we calculated our effect sizes (log response ratio lnRR) for our complete data set (all traits).

```{r, include = FALSE}


#Import data
ALL_TRAITS <- read_excel("../data/ALL_TRAITS.xlsx")

MG_ALL <- read_excel("../data/MG_ALL.xlsx")

OF_ALL <- read_excel("../data/OF_ALL.xlsx")

Overall_effect_size <- read_excel("../data/Overall effect size.xlsx")

Overall_MG_OF <- read_excel("../data/Overall_MG_OF.xlsx")

Overall_effects_not_split <- read_excel("../data/Overall_effects_not_split.xlsx")

Table_results_overall <- read_excel("../data/Table results.xlsx")

Overall_lnCVR <- read_excel("../data/Overall_lnCVR.xlsx")

MG_ALL_lnCVR <- read.csv("../data/MG_ALL_lnCVR.csv")

OF_ALL_lnCVR <- read.csv("../data/OF_ALL_lnCVR.csv")

Overall_MG_OF_lnCVR <- read_excel("../data/Overall_MG_OF_lnCVR.xlsx")

Overall_effects_not_split_lnCVR <- read_excel("../data/Overall_effects_not_split_lnCVR.xlsx")

Table_results_overall_lnCVR <- read_excel("../data/Table_results_overall_lnCVR.xlsx")



```

## Meta-analysis overall results (lnRR)

### 1. Calculating effect sizes (Done)

We calculated our effect sizes (log response ratio lnRR) for our complete data set (all traits).
```{r, include = FALSE}

Effect_Size_All_Traits <- escalc(measure="ROM", m1i=Mean_Treatment, sd1i=SD_Treatment, n1i=Sample_Size_n_Treatment, m2i=Mean_Control, sd2i=SD_Control, n2i=Sample_Size_n_Control, data=ALL_TRAITS)

hist(Effect_Size_All_Traits$yi)
hist(log(Effect_Size_All_Traits$vi))
```

### 2. Deciding random effects (Done)
We used AIC values to decide which random effects to use. Combining "Trait", "Paper_ID" and "Cohort_ID" yielded the lowest AIC values. 
```{r, include= FALSE}
meta1null <- rma.mv(yi, vi, data=Effect_Size_All_Traits, method = 'ML') 

metastudy <- rma.mv(yi, vi,random = ~1|Cohort_ID, data=Effect_Size_All_Traits, method = 'ML') 
anova(meta1null, metastudy)
meta0study <- rma.mv(yi, vi,random = list(~1|Paper_ID, ~1|Cohort_ID), data=Effect_Size_All_Traits, method = 'ML') 
anova(meta1null, meta0study)
meta1study <- rma.mv(yi, vi,random = ~1|Trait, data=Effect_Size_All_Traits, method = 'ML') 
anova(meta1null, meta1study)
metastudy_best <- rma.mv(yi, vi,random = list(~1|Paper_ID,~1|Cohort_ID,~1|Trait), data=Effect_Size_All_Traits, method = 'ML') 
anova(meta0study, metastudy_best)

```

#### 3. Running meta-analysis (overall, and then overall split by exposure type)
I conducted meta-analysis, first on the complete dataset, and then on subsetted data (split by one off and multigenerational exposure)

```{r, include = FALSE}
#ALL DATA

All_Traits_Analysis_0mods <- rma.mv(yi, vi, random = list(~1|Trait, ~1|Paper_ID,~1|Cohort_ID), data=Effect_Size_All_Traits, method = 'REML')

All_Traits_Analysis_traits <- rma.mv(yi, vi, mods= ~Trait-1, random = list(~1|Paper_ID,~1|Cohort_ID), data=Effect_Size_All_Traits, method = 'REML')

summary(All_Traits_Analysis_traits)

Traits_overall_lnRR <- tibble(
  Trait = c("Adiposity", "Body Weight","Glucose", "Insulin", "Leptin", "Triglycerides"), 
  lnRR = c(0.5139,0.1103,0.0861,0.1724,0.1228,0.2360),
  ci.lb = c(0.3838,-0.0141,-0.0404,0.0424,-0.0116,0.1056),
  ci.ub = c(0.6439,0.2346,0.2127,0.3024,0.2572,0.3664)
)
Traits_overall_lnRR

k_traits <- Effect_Size_All_Traits %>% group_by(Trait) %>% count()
k_traits

plot_lnRR_overall_traits <- ggplot(Traits_overall_lnRR, aes(x=Trait, y=lnRR, colour = Trait)) + 
  geom_errorbar(aes(ymin=ci.lb, ymax=ci.ub), width = 0, position = position_dodge(0.3)) +
  geom_point(aes(x = Trait, y = lnRR), position = position_dodge(0.3))+
  geom_hline(yintercept = 0, lty = "dotted") +
  labs(x = "Trait", y = "lnRR") +
  coord_flip()
plot_lnRR_overall_traits

summary(All_Traits_Analysis_0mods)
funnel(All_Traits_Analysis_0mods)

W <- diag(1/Effect_Size_All_Traits$vi)
X <- model.matrix(All_Traits_Analysis_0mods)
P <- W - W %*% X %*% solve(t(X) %*% W %*% X) %*% t(X) %*% W
I2_overall <- 100 * sum(All_Traits_Analysis_0mods$sigma2) / (sum(All_Traits_Analysis_0mods$sigma2) + (All_Traits_Analysis_0mods$k-All_Traits_Analysis_0mods$p)/sum(diag(P)))
I2_overall

# Modelling all traits with no mods MG (lnRR)
All_Traits_Analysis_0mods_MG <- rma.mv(yi, vi, random = list(~1|Trait, ~1|Paper_ID,~1|Cohort_ID), data=MG_ALL, method = 'REML')

summary(All_Traits_Analysis_0mods_MG)

#Heterogeneity I2 (adapt for all models)
W <- diag(1/MG_ALL$vi)
X <- model.matrix(All_Traits_Analysis_0mods_MG)
P <- W - W %*% X %*% solve(t(X) %*% W %*% X) %*% t(X) %*% W
I2_MG <- 100 * sum(All_Traits_Analysis_0mods_MG$sigma2) / (sum(All_Traits_Analysis_0mods_MG$sigma2) + (All_Traits_Analysis_0mods_MG$k-All_Traits_Analysis_0mods_MG$p)/sum(diag(P)))
I2_MG

# Modelling all traits with no mods OF (lnRR)
All_Traits_Analysis_0mods_OF <- rma.mv(yi, vi, random = list(~1|Trait, ~1|Paper_ID,~1|Cohort_ID), data=OF_ALL, method = 'REML')

summary(All_Traits_Analysis_0mods_OF)

W <- diag(1/OF_ALL$vi)
X <- model.matrix(All_Traits_Analysis_0mods_OF)
P <- W - W %*% X %*% solve(t(X) %*% W %*% X) %*% t(X) %*% W
I2_OF <- 100 * sum(All_Traits_Analysis_0mods_OF$sigma2) / (sum(All_Traits_Analysis_0mods_OF$sigma2) + (All_Traits_Analysis_0mods_OF$k-All_Traits_Analysis_0mods_OF$p)/sum(diag(P)))
I2_OF


#Dataframe was created using results from above meta-analysis models
```

### Plotting overall results
```{r,echo=FALSE}


plot_lnRR_overall <- ggplot(Overall_effect_size, aes(x=ID, y=Effect_Size_lnRR)) + 
  geom_errorbar(aes(ymin=ci.lb, ymax=ci.ub), width = 0, position = position_dodge(0.3)) +
  geom_point(aes(x = ID, y = Effect_Size_lnRR), position = position_dodge(0.3))+
  geom_hline(yintercept = 0, lty = "dotted") +
  labs(x = "ID", y = "lnRR", subtitle = "k=341") +
  coord_flip()
plot_lnRR_overall
```

### Plotting overall results when split by multigenerational and one off exposure
```{r, echo = FALSE}



plot_lnRR_overall_exposure <- ggplot(Overall_MG_OF, aes(x=ID, y=Effect_Size_lnRR, colour=Experiment_Type)) + 
  geom_errorbar(aes(ymin=ci.lb, ymax=ci.ub), width = 0, position = position_dodge(0.3)) +
  geom_point(aes(x = ID, y = Effect_Size_lnRR), position = position_dodge(0.3))+
  geom_hline(yintercept = 0, lty = "dotted") +
  labs(x = "ID", y = "lnRR") +
  coord_flip()
 
plot_lnRR_overall_exposure

```

#### Running meta-analysis (Overall with moderators, and then overall split by exposure type with moderators)

```{r, include=FALSE}
#Adding moderators
All_Data_Analysis_Exp_Type <- rma.mv(yi, vi, mods = ~Exposure_Type-1, random = list(~1|Trait, ~1|Paper_ID,~1|Cohort_ID), data=Effect_Size_All_Traits, method = 'REML')

All_Data_Analysis_Exp_Type



All_Data_Analysis_f0 <- rma.mv(yi, vi, mods = ~F0_Parent_Exposed-1, random = list(~1|Trait, ~1|Paper_ID,~1|Cohort_ID), data=Effect_Size_All_Traits, method = 'REML')

summary(All_Data_Analysis_f0)

k_All_Data_Analysis_f0 <- Effect_Size_All_Traits %>% group_by(F0_Parent_Exposed) %>% count()
k_All_Data_Analysis_f0

All_Data_Analysis_sex <- rma.mv(yi, vi, mods = ~Sex-1, random = list(~1|Trait, ~1|Paper_ID,~1|Cohort_ID), data=Effect_Size_All_Traits, method = 'REML')

summary(All_Data_Analysis_sex)
```

### Plotting overall results with moderators
```{r, echo=FALSE}
Overall_effects_not_split <- tibble(
  ID = c("Both F0", "F0 Female", "F0 Male", "Both Sexes Grand Offspring", "Female Grand Offspring", "Male Grand Offspring"),
  lnRR = c(All_Data_Analysis_f0$b[1],All_Data_Analysis_f0$b[2],All_Data_Analysis_f0$b[3],All_Data_Analysis_sex$b[1],All_Data_Analysis_sex$b[2],All_Data_Analysis_sex$b[3]),
  ci.lb = c(All_Data_Analysis_f0$ci.lb[1],All_Data_Analysis_f0$ci.lb[2],All_Data_Analysis_f0$ci.lb[3],All_Data_Analysis_sex$ci.lb[1],All_Data_Analysis_sex$ci.lb[2],All_Data_Analysis_sex$ci.lb[3]),
  ci.ub = c(All_Data_Analysis_f0$ci.ub[1],All_Data_Analysis_f0$ci.ub[2],All_Data_Analysis_f0$ci.ub[3],All_Data_Analysis_sex$ci.ub[1],All_Data_Analysis_sex$ci.ub[2],All_Data_Analysis_sex$ci.ub[3])
)


plot_lnRR_overall_mods <- ggplot(Overall_effects_not_split, aes(x=ID, y=lnRR))+ 
  geom_errorbar(aes(ymin=ci.lb, ymax=ci.ub), width = 0, position = position_dodge(0.3)) +
  geom_point(aes(x = ID, y = lnRR), position = position_dodge(0.3))+
  geom_hline(yintercept = 0, lty = "dotted") +
  labs(x = "ID", y = "lnRR") +
  coord_flip()
 
plot_lnRR_overall_mods

```

```{r, include=FALSE}

#Split by exposure type and with moderators


#Adding moderators
All_Traits_Analysis_0mods_MG_f0 <- rma.mv(yi, vi, mods = ~F0_Parent_Exposed-1, random = list(~1|Trait, ~1|Paper_ID,~1|Cohort_ID), data=MG_ALL, method = 'REML')

summary(All_Traits_Analysis_0mods_MG_f0)


All_Traits_Analysis_0mods_OF_f0 <- rma.mv(yi, vi, mods = ~F0_Parent_Exposed-1, random = list(~1|Trait, ~1|Paper_ID,~1|Cohort_ID), data=OF_ALL, method = 'REML')

summary(All_Traits_Analysis_0mods_OF_f0)

All_Traits_Analysis_0mods_MG_sex <- rma.mv(yi, vi, mods = ~Sex-1, random = list(~1|Trait, ~1|Paper_ID,~1|Cohort_ID), data=MG_ALL, method = 'REML')

summary(All_Traits_Analysis_0mods_MG_sex)


All_Traits_Analysis_0mods_OF_sex <- rma.mv(yi, vi, mods = ~Sex-1, random = list(~1|Trait, ~1|Paper_ID,~1|Cohort_ID), data=OF_ALL, method = 'REML')

summary(All_Traits_Analysis_0mods_OF_sex)


```


### Plotting Overall results with moderators (split by exposure type)
```{r, echo = FALSE}
Table_results_overall <- tibble(
  ID = c("F0 Female", "F0 Male","F0 Both","F0 Female","F0 Male","Both Sex Grand Offspring", "Female Grand Offspring", "Male Grand Offspring","Both Sex Grand Offspring", "Female Grand Offspring", "Male Grand Offspring" ),
  Experiment_Type = c("Multigenerational", "Multigenerational","One off","One off","One off", "Multigenerational", "Multigenerational", "Multigenerational","One off","One off", "One off") ,
  lnRR = c(0.4173,0.3025,0.1873,0.0747,0.0491,1.0519,0.1172,0.1246,-0.3802,0.0729,0.0790),
  ci.lb = c(0.0521,-0.3288,0.0930,0.0237,-0.0134,0.4842,-0.3928,-0.3865,-0.6536,0.0235,0.0306),
  ci.ub = c(0.7826,0.9337,0.2816,0.1257,0.1116,1.6196,0.6271,0.6358,-0.1068,0.1222,0.1274)
)


Table_results_overall

plot_lnRR_overall_mods_exp <- ggplot(Table_results_overall, aes(x=ID, y=lnRR, colour=Experiment_Type)) + 
  geom_errorbar(aes(ymin=ci.lb, ymax=ci.ub), width = 0, position = position_dodge(0.3)) +
  geom_point(aes(x = ID, y = lnRR), position = position_dodge(0.3))+
  geom_hline(yintercept = 0, lty = "dotted") +
  labs(title ="Difference between treatment and control in means, overall mods", x = "ID", y = "lnRR") +
  coord_flip()
 
plot_lnRR_overall_mods_exp


```

## Meta-analysis overall results (lnCVR)

### 4. Calculating effect sizes (Done)

We calculated our effect sizes (lnCVR) for our complete data set (all traits).
```{r, include = FALSE}

Effect_Size_All_Traits_lnCVR <- escalc(measure="CVR", m1i=Mean_Treatment, sd1i=SD_Treatment, n1i=Sample_Size_n_Treatment, m2i=Mean_Control, sd2i=SD_Control, n2i=Sample_Size_n_Control, data=ALL_TRAITS)

#Converting into factors

Effect_Size_All_Traits_lnCVR$Trait <- factor(Effect_Size_All_Traits_lnCVR$Trait)
Effect_Size_All_Traits_lnCVR$Exposure_Type <- factor(Effect_Size_All_Traits_lnCVR$Exposure_Type)
Effect_Size_All_Traits_lnCVR$Sex <- factor(Effect_Size_All_Traits_lnCVR$Sex)
Effect_Size_All_Traits_lnCVR$Generation <- factor(Effect_Size_All_Traits_lnCVR$Generation)
Effect_Size_All_Traits_lnCVR$Cohort_ID <- factor(Effect_Size_All_Traits_lnCVR$Cohort_ID)
Effect_Size_All_Traits_lnCVR$Paper_ID <- factor(Effect_Size_All_Traits_lnCVR$Paper_ID)
Effect_Size_All_Traits_lnCVR$Rodent_type <- factor(Effect_Size_All_Traits_lnCVR$Rodent_type)
Effect_Size_All_Traits_lnCVR$F2_Diet_at_measurement <- factor(Effect_Size_All_Traits_lnCVR$F2_Diet_at_measurement)
Effect_Size_All_Traits_lnCVR$Strain <- factor(Effect_Size_All_Traits_lnCVR$Strain)
Effect_Size_All_Traits_lnCVR$F0_Parent_Exposed <- factor(Effect_Size_All_Traits_lnCVR$F0_Parent_Exposed)

Effect_Size_All_Traits_lnCVR$Sex <- gsub("Both ", "Both", Effect_Size_All_Traits_lnCVR$Sex)
```

#### 5. Running meta-analysis for lnCVR (overall, and then overall split by exposure type)
I conducted meta-analysis using lnCVR, first on the complete dataset, and then on subsetted data (split by one off and multigenerational exposure)

```{r, include = FALSE}
#ALL OF and MG

All_Traits_Analysis_0mods_lnCVR <- rma.mv(yi, vi, random = list(~1|Trait, ~1|Paper_ID,~1|Cohort_ID), data=Effect_Size_All_Traits_lnCVR, method = 'REML')

summary(All_Traits_Analysis_0mods_lnCVR)
funnel(All_Traits_Analysis_0mods_lnCVR)

W <- diag(1/Effect_Size_All_Traits_lnCVR$vi)
X <- model.matrix(All_Traits_Analysis_0mods_lnCVR)
P <- W - W %*% X %*% solve(t(X) %*% W %*% X) %*% t(X) %*% W
I2_overall_lnCVR <- 100 * sum(All_Traits_Analysis_0mods_lnCVR$sigma2) / (sum(All_Traits_Analysis_0mods_lnCVR$sigma2) + (All_Traits_Analysis_0mods_lnCVR$k-All_Traits_Analysis_0mods_lnCVR$p)/sum(diag(P)))
I2_overall_lnCVR

# Modelling all traits with no mods MG (lnCVR)
All_Traits_Analysis_0mods_MG_lnCVR <- rma.mv(yi, vi, random = list(~1|Trait, ~1|Paper_ID,~1|Cohort_ID), data=MG_ALL_lnCVR, method = 'REML')


summary(All_Traits_Analysis_0mods_MG_lnCVR)

#Heterogeneity I2 (adapt for all models)
W <- diag(1/MG_ALL_lnCVR$vi)
X <- model.matrix(All_Traits_Analysis_0mods_MG_lnCVR)
P <- W - W %*% X %*% solve(t(X) %*% W %*% X) %*% t(X) %*% W
I2_MG_lnCVR <- 100 * sum(All_Traits_Analysis_0mods_MG_lnCVR$sigma2) / (sum(All_Traits_Analysis_0mods_MG_lnCVR$sigma2) + (All_Traits_Analysis_0mods_MG_lnCVR$k-All_Traits_Analysis_0mods_MG_lnCVR$p)/sum(diag(P)))
I2_MG

# Modelling all traits with no mods OF (lnCVR)
All_Traits_Analysis_0mods_OF_lnCVR <- rma.mv(yi, vi, random = list(~1|Trait, ~1|Paper_ID,~1|Cohort_ID), data=OF_ALL_lnCVR, method = 'REML')

summary(All_Traits_Analysis_0mods_OF_lnCVR)

All_Traits_Analysis_traits_lnCVR <- rma.mv(yi, vi, mods= ~Trait-1, random = list(~1|Paper_ID,~1|Cohort_ID), data=Effect_Size_All_Traits_lnCVR, method = 'REML')

summary(All_Traits_Analysis_traits_lnCVR)

Traits_overall_lnCVR <- tibble(
  Trait = c("Adiposity", "Body Weight","Glucose", "Insulin", "Leptin", "Triglycerides"), 
  lnCVR = c(-0.0107,0.0261,0.0143,-0.1468,0.0245,-0.0817),
  ci.lb = c(-0.1557,-0.0742,-0.1343,-0.3042,-0.2159,-0.2524),
  ci.ub = c(0.1343,0.1264,0.1629,0.0106,0.2648,0.0891)
)
Traits_overall_lnCVR

plot_lnRR_overall_traits_lnCVR <- ggplot(Traits_overall_lnCVR, aes(x=Trait, y=lnCVR, colour = Trait)) + 
  geom_errorbar(aes(ymin=ci.lb, ymax=ci.ub), width = 0, position = position_dodge(0.3)) +
  geom_point(aes(x = Trait, y = lnCVR), position = position_dodge(0.3))+
  geom_hline(yintercept = 0, lty = "dotted") +
  labs(x = "Trait", y = "lnCVR") +
  coord_flip()
plot_lnRR_overall_traits_lnCVR

#Dataframe was created using results from above meta-analysis models
```

### Plotting overall results lnCVR
```{r,echo=FALSE}


plot_lnCVR_overall <- ggplot(Overall_lnCVR, aes(x=ID, y=Effect_Size_lnCVR, colour=Experiment_Type)) + 
  geom_errorbar(aes(ymin=ci.lb, ymax=ci.ub), width = 0, position = position_dodge(0.3)) +
  geom_point(aes(x = ID, y = Effect_Size_lnCVR), position = position_dodge(0.3))+
  geom_hline(yintercept = 0, lty = "dotted") +
  labs(x = "ID", y = "lnCVR", subtitle = "k=341") +
  coord_flip()
plot_lnCVR_overall
```

### Plotting overall results when split by multigenerational and one off exposure (lnCVR)
```{r, echo = FALSE}



plot_lnCVR_overall_exposure <- ggplot(Overall_MG_OF_lnCVR, aes(x=ID, y=Effect_Size_lnCVR, colour=Experiment_Type)) + 
  geom_errorbar(aes(ymin=ci.lb, ymax=ci.ub), width = 0, position = position_dodge(0.3)) +
  geom_point(aes(x = ID, y = Effect_Size_lnCVR), position = position_dodge(0.3))+
  geom_hline(yintercept = 0, lty = "dotted") +
  labs(x = "ID", y = "lnCVR") +
  coord_flip()
 
plot_lnCVR_overall_exposure

```




#### Running meta-analysis lnCVR (Overall with moderators, and then overall split by exposure type with moderators)

```{r, include=FALSE}
#Adding moderators
All_Data_Analysis_f0_lnCVR <- rma.mv(yi, vi, mods = ~F0_Parent_Exposed-1, random = list(~1|Trait, ~1|Paper_ID,~1|Cohort_ID), data=Effect_Size_All_Traits_lnCVR, method = 'REML')

summary(All_Data_Analysis_f0_lnCVR)



All_Data_Analysis_sex_lnCVR <- rma.mv(yi, vi, mods = ~Sex-1, random = list(~1|Trait, ~1|Paper_ID,~1|Cohort_ID), data=Effect_Size_All_Traits_lnCVR, method = 'REML')

summary(All_Data_Analysis_sex_lnCVR)
```

### Plotting overall results with moderators
```{r, echo=FALSE}



plot_lnCVR_overall_mods <- ggplot(Overall_effects_not_split_lnCVR, aes(x=ID, y=Effect_Size_lnCVR, colour=Experiment_Type)) + 
  geom_errorbar(aes(ymin=ci.lb, ymax=ci.ub), width = 0, position = position_dodge(0.3)) +
  geom_point(aes(x = ID, y = Effect_Size_lnCVR), position = position_dodge(0.3))+
  geom_hline(yintercept = 0, lty = "dotted") +
  labs(x = "ID", y = "lnCVR") +
  coord_flip()
 
plot_lnCVR_overall_mods

```

```{r, include=FALSE}

#Split by exposure type and with moderators


#Adding moderators
All_Traits_Analysis_lnCVR_MG_f0 <- rma.mv(yi, vi, mods = ~F0_Parent_Exposed-1, random = list(~1|Trait, ~1|Paper_ID,~1|Cohort_ID), data=MG_ALL_lnCVR, method = 'REML')

summary(All_Traits_Analysis_lnCVR_MG_f0)


All_Traits_Analysis_lnCVR_OF_f0 <- rma.mv(yi, vi, mods = ~F0_Parent_Exposed-1, random = list(~1|Trait, ~1|Paper_ID,~1|Cohort_ID), data=OF_ALL_lnCVR, method = 'REML')

summary(All_Traits_Analysis_lnCVR_OF_f0)

All_Traits_Analysis_lnCVR_MG_sex <- rma.mv(yi, vi, mods = ~Sex-1, random = list(~1|Trait, ~1|Paper_ID,~1|Cohort_ID), data=MG_ALL_lnCVR, method = 'REML')

summary(All_Traits_Analysis_lnCVR_MG_sex)


All_Traits_Analysis_lnCVR_OF_sex <- rma.mv(yi, vi, mods = ~Sex-1, random = list(~1|Trait, ~1|Paper_ID,~1|Cohort_ID), data=OF_ALL_lnCVR, method = 'REML')

summary(All_Traits_Analysis_lnCVR_OF_sex)


```


### Plotting Overall results with moderators (split by exposure type)
```{r, echo = FALSE}



plot_lnCVR_overall_mods_exp <- ggplot(Table_results_overall_lnCVR, aes(x=ID, y=Effect_Size_lnCVR, colour=Experiment_Type)) + 
  geom_errorbar(aes(ymin=ci.lb, ymax=ci.ub), width = 0, position = position_dodge(0.3)) +
  geom_point(aes(x = ID, y = Effect_Size_lnCVR), position = position_dodge(0.3))+
  geom_hline(yintercept = 0, lty = "dotted") +
  labs(title ="Difference between treatment and control in means, overall mods, lnCVR", x = "ID", y = "lnCVR") +
  coord_flip()
 
plot_lnCVR_overall_mods_exp


```





